# Default server configuration
# Located on /etc/nginx/sites-available/{{ domain }}
#
server {
    listen 80 default_server; #Default port
    listen [::]:80 default_server;

    # Redirect all HTTP requests to HTTPS with a 301 Moved Permanently response.
    return 301 https://$host$request_uri;
        }

server {

        listen 443 ssl http2 ; #encrypted port
        listen [::]:443 ssl http2;


        root /var/www/{{ domain }};

        index index.php index.html ;

        # Enable ssl certificate
        ssl on;
        ssl_certificate /etc/nginx/ssl/nginx.crt;
        ssl_certificate_key /etc/nginx/ssl/nginx.key;

        #enable php on Nginx
        location ~ \.php$ {
        try_files $uri =404;
        fastcgi_pass unix:/var/run/php/php7.0-fpm.sock;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param HTTPS on;
        include fastcgi_params;
                          }
}
